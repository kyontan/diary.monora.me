# 2018-04-01 (Sun)

## 天気

- 晴れ
  - 清々しい春の1日

## 時系列

- 1:09: ハーゲンダッツ
- 1:30 - 3:00: NEW GAME! (7) を読む
- 3:05: 就寝
- 13:55: 起床
- 14:00 - 15:30: MTG
- 15:30 - 16:00: 部誌の原稿読み
- 16:30 - 17:30: 運転
- 18:00 - 21:00: 自宅ネットワーク改造(1): IPv6 と格闘して負ける, AP の設定変える
- 21:30 - 22:00: 春アニメ予約
- 21:00 - 23:00: 裏で劇場版 SAO 観てた
- 22:00 - 23:30: 自宅ネットワーク改造(2): CoreDNS, ブログのテンプレート手直し
- 23:30 - : http://diary.monora.me 設定

## 雑感

### NEW GAME! (7)

(6) はまだ読んでないと思うのだけど、連載の方で読んでいるので多分大丈夫だろうと思いながら買った。
これは当たったらしく、(7) はアニメ2期の直後の時系列っぽい。
読んだ記憶のあるエピソードが全くなくていかにきらら本誌を積んでいるかが分かる。

NEW GAME! は面白くて、あと作画のレベルが高い。キャラクターの機微で人を悶えさせることに長けている作品だと思う。
特に望月紅葉さんが良かった。

### 就寝

そもそもMMAの追い出し帰りで久々に美味しい酒をたらふく飲んだので酔っ払っていたこともあって寝付きが若干悪かった。

### 起床

14:00 から MTG があったことを覚えていてよかった

### 部誌

MMA の部誌の〆切は明後日らしい。
何か書こうと思っているがとくにこれという技術的なトピックが思い当たらない。
別に部誌だからといって技術的のトピックを扱わないと行けないわけではないが、とはいえこういった日記的な文章を団体の代表する発行物で永久に残すのもどうかと思う。
大きな目的は新入生勧誘なので、新入生に役に立つ情報をまとめるぐらいが良いだろうか。JobHunting は過激すぎるし団体の活動に関わる恐れがある。

### 自宅ネットワーク改造

自宅のONU兼ルータがNTT東のPR-S300SEなのだけれど、これに内部DNSを引かせようとすると IPv6 アドレスを持つDNSサーバしか受け入れない。
自宅から monora.me にアクセスする頻度はそこそこあり、その度にネットワーク設定を変えて内部DNSへ向けるのも怠いので重い腰を上げることにした。
詳しい設定画面を見るまで気が付かなかったが、DHCPで配るDNSサーバを変更するのではなく、特定ドメインに対するDNSサーバを設定するようになっていた。内部実装が透けて見えるな。

前述した通り、元より自宅のサーバではDNSサーバが動いていたので IPv6 reachable になれば良い。と思ったがRA周りがうまく動かず断念。
間に入っているL3スイッチの Cisco Catalyst 3750G がパススルーしないのか? 該当ポートは `switchport` だから L2相当なはずだが……
自宅の別の場所にある別のサーバが IPv6 を持っていたため、そちらからプロキシする方針に変更。

プロキシするだけなのでなんでもいいのだが、いい感じの DNSサーバを探していたら [CoreDNS](https://coredns.io) が見つかった。
CNCF なのは前から知っていたし、ドキュメントを眺めていたら割と良い感じだったので使ってみることに。
嬉しいことに [fallback plugin](https://github.com/coredns/fallback) があり、その名の通りの挙動をする。容易でDNSサーバの挙動を変えられるのは面白い。
自宅のDNSサーバは monora.me や pref.yokohama の全てのレコードを持っていなくて、外部向けの DNSaaS である Gehirn DNS 側に登録したレコードがいくつかある。
fallback plugin を使うことで、ローカルのDNSサーバに該当のレコードがなかった場合に Gehirn DNS 側に問い合わせることができる。最高。

Go で書かれているのでサクッと CoreDNS のソースコードを編集して plugin を有効化してリビルド。
ところで plugin.cfg を弄るとプラグインが有効になるのはよく出来ている。 `go generate` とかでごにょごにょしているっぽい。

- - -

他にも自宅のネットワークが最近悲惨な状況にある。
メインの Wi-Fi AP である ASUS RT-AC68U が死んでいて、通信はできるが WebUI が一向に開けない。これは大丈夫なのか……??
自室は MacBook Air のインターネット共有 as Wi-Fi AP 運用なので良いが、自室から出たらインターネットが使えないのは困る。

とりあえず自室にあるが使っていない Aironet の設定を変えてパスワードを家族に共有した。あとで自宅の中心に配置しようと思う。

### 劇場版SAO

AbemaTV でやってるというのを Twitter で観たのでちらちら眺めていた。設定が何もわからなかったが東工大と恵比寿ガーデンプレイスだけは分かった。
キリトとアスナ、そういう関係だったの……

### ブログのテンプレート手直し

[monolog](https://blog.monora.me) をモバイル環境で見るとぶっ壊れるというのが知られていた。
具体的には個別記事のページにおいて、最下部のコメントフォームのせいで横幅が1.5倍ぐらいになる問題があった。
これを直したのと、モバイルで見た時にフォントサイズを少し小さくするようにした。

ところで monora.me とかその関連サイトは基本的に [TypeSquare](https://typesquare.com/ja/) の無料プランで新丸ゴを使っているのだけれど、1ウェイトしかないのがちょっとつらい。
2500円/月払うほど儲かってはいないので……

### diary.monora.me

これ。流石にこういう内容を [monolog](https://blog.monora.me) に書くのは憚られたので雑に書こうと思い立ってやった。

最近は知り合いの [これ](https://makenowjust.github.io/diary/) とか [これ](https://mt-caret.github.io/nippo/) を見ていて、これの体裁は後者に寄せている。本当に?

実装は前者は Travis CI を使ってビルドしていて、後者は多分 Pandoc でローカルビルドしている。色々ある。

最近あまり github.io を使って静的ホストジェネレート! みたいな記事を見ないけれど、これはコモディティ化によるものな気がする。
独自ドメインを使うと https 化対応がされないのは厳しいですね。外でもブログ系SaaS はこのあたり大変そう。

## 明日

8:40 に起きないと死ぬらしい。



